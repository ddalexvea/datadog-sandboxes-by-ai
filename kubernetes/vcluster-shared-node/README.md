[{"text": "# Datadog Agent Container Metrics - Shared Node in vcluster\n\n## Context\n\nWhen running Datadog agents inside vclusters that share the same physical node, the agent cannot access the host kubelet because vcluster ServiceAccount tokens are not recognized by the host kubelet. This results in:\n- `401 Unauthorized` errors when accessing kubelet endpoints\n- `nil stats` for containers (the original customer issue)\n- Missing CPU/memory usage metrics for pods\n\nThe root cause is that vclusters have their own API server and issue their own tokens, which the host kubelet does not trust.\n\n**Full documentation available in the original repository:** [datadog-agent-containers-info-shared-node-in-vcluster](https://github.com/ddalexvea/datadog-agent-containers-info-shared-node-in-vcluster)\n\n## Key Topics\n\n- vcluster agent deployment challenges\n- Kubelet authentication with vcluster tokens\n- 401 Unauthorized errors\n- Workaround using host cluster ServiceAccount tokens\n- Init container to replace vcluster SA token\n", "type": "text"}]